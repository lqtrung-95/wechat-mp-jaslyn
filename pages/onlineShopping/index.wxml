<view class="page">
  <view class="language-toggle">
    <button class="language-toggle__btn" bindtap="toggleLanguage">{{globalCopy.languageToggleLabel}}</button>
  </view>

  <view class="form-card">
    <view class="form-card__header">
      <view class="form-card__emoji">üì¶</view>
      <view>
        <view class="form-card__title">{{pageCopy.heroTitle}}</view>
        <view class="form-card__subtitle">{{pageCopy.heroSubtitle}}</view>
      </view>
    </view>

    <view class="info-banner info-banner--supported">
      <view class="info-banner__title">üåê {{globalCopy.supportedAreasTitle}}</view>
      <view class="info-banner__body">
        <text class="info-banner__text">{{supportedSummary ? globalCopy.supportedAreasHint + supportedSummary : globalCopy.supportedAreasFallback}}</text>
        <text class="info-banner__desc">{{globalCopy.supportedAreasDescription}}</text>
      </view>
    </view>

    <view class="section">
      <view class="section__title">
        <text class="section__icon">üìç</text>
        <text>{{globalCopy.deliverySectionTitle}}</text>
      </view>

      <view class="section__grid">
        <view class="field field--half">
          <text class="field__label">{{globalCopy.countryLabel}} *</text>
          <picker mode="selector" range="{{countryOptions}}" value="{{selectedCountryIndex < 0 ? 0 : selectedCountryIndex}}" bindchange="handleCountryChange">
            <view class="picker__trigger">
              <text class="picker__text {{isCustomCountry || selectedCountryIndex === -1 ? 'picker__text--placeholder' : ''}}">{{isCustomCountry ? globalCopy.customOptionLabel : selectedCountryIndex > -1 ? formData.country : globalCopy.countryLabel}}</text>
              <text class="picker__chevron">‚åµ</text>
            </view>
          </picker>
        </view>

        <view class="field field--half">
          <text class="field__label">{{globalCopy.cityLabel}} *</text>
          <picker mode="selector" range="{{cityOptions}}" value="{{selectedCityIndex < 0 ? 0 : selectedCityIndex}}" bindchange="handleCityChange" disabled="{{isCustomCountry || !cityOptions.length}}">
            <view class="picker__trigger {{isCustomCountry || !cityOptions.length ? 'picker__trigger--disabled' : ''}}">
              <text class="picker__text {{isCustomCountry || selectedCityIndex === -1 ? 'picker__text--placeholder' : ''}}">
                {{isCustomCountry ? globalCopy.customCityLabel : selectedCityIndex > -1 ? formData.city : globalCopy.cityLabel}}
              </text>
              <text class="picker__chevron">‚åµ</text>
            </view>
          </picker>
        </view>

        <view class="field field--half" wx:if="{{isCustomCountry}}">
          <text class="field__label">{{globalCopy.customCountryLabel}}</text>
          <input class="field__control" placeholder="{{globalCopy.customCountryPlaceholder}}" value="{{formData.customCountry}}" data-field="customCountry" bindinput="handleInput" />
        </view>

        <view class="field field--half" wx:if="{{isCustomCountry}}">
          <text class="field__label">{{globalCopy.customCityLabel}}</text>
          <input class="field__control" placeholder="{{globalCopy.customCityPlaceholder}}" value="{{formData.customCity}}" data-field="customCity" bindinput="handleInput" />
        </view>

        <view class="field field--full">
          <text class="field__label">{{globalCopy.districtLabel}}</text>
          <input class="field__control" placeholder="{{globalCopy.districtPlaceholder}}" value="{{formData.district}}" data-field="district" bindinput="handleInput" />
        </view>

        <view class="field field--full">
          <text class="field__label">{{globalCopy.detailAddressLabel}}</text>
          <textarea class="field__textarea" placeholder="{{globalCopy.detailAddressPlaceholder}}" value="{{formData.detailAddress}}" data-field="detailAddress" bindinput="handleInput"></textarea>
        </view>
      </view>

      <text class="note note--secondary">{{globalCopy.cityNote}}</text>
      <text class="form-hint">{{globalCopy.formAddressHint}}</text>

      <view wx:if="{{validationResult}}" class="message-banner {{validationResult.state}}">{{validationResult.message}}</view>

      <view class="section__actions">
        <button class="secondary-btn" bindtap="handleValidateAddress" loading="{{validating}}" disabled="{{validating}}">{{globalCopy.validationButton}}</button>
      </view>
    </view>

    <view class="section">
      <view class="section__title">
        <text class="section__icon">üõçÔ∏è</text>
        <text>{{globalCopy.requirementsSectionTitle}}</text>
      </view>
      <view class="field field--full">
        <text class="field__label">{{pageCopy.requirementLabel}} *</text>
        <input class="field__control" placeholder="{{pageCopy.requirementPlaceholder}}" value="{{formData.foodType}}" data-field="foodType" bindinput="handleInput" />
      </view>
      <view class="field field--full">
        <text class="field__label">{{globalCopy.notesLabel}}</text>
        <textarea class="field__textarea" placeholder="{{globalCopy.notesPlaceholder}}" value="{{formData.notes}}" data-field="notes" bindinput="handleInput"></textarea>
      </view>
      <view class="helper-list">
        <text class="helper-list__intro">{{globalCopy.notesHelperIntro}}</text>
        <view class="helper-list__item" wx:for="{{globalCopy.notesHelperBullets}}" wx:key="*this">‚Ä¢ {{item}}</view>
      </view>
    </view>

    <view class="section">
      <view class="section__title">
        <text class="section__icon">‚òéÔ∏è</text>
        <text>{{globalCopy.contactSectionTitle}}</text>
      </view>
      <view class="section__grid">
        <view class="field field--half">
          <text class="field__label">{{globalCopy.contactNameLabel}} *</text>
          <input class="field__control" placeholder="{{globalCopy.contactNamePlaceholder}}" value="{{formData.customerName}}" data-field="customerName" bindinput="handleInput" />
        </view>
        <view class="field field--half">
          <text class="field__label">{{globalCopy.contactPhoneLabel}} *</text>
          <input class="field__control" placeholder="{{globalCopy.contactPhonePlaceholder}}" value="{{formData.customerPhone}}" data-field="customerPhone" bindinput="handleInput" />
        </view>
        <view class="field field--full">
          <text class="field__label">{{globalCopy.contactWechatLabel}}</text>
          <input class="field__control" placeholder="{{globalCopy.contactWechatPlaceholder}}" value="{{formData.customerWechat}}" data-field="customerWechat" bindinput="handleInput" />
        </view>
      </view>
    </view>

    <view wx:if="{{submitResult}}" class="message-banner {{submitResult.state}}">{{submitResult.message}}</view>
    <text class="note note--danger">{{globalCopy.submitReminder}}</text>

    <button class="primary-btn primary-btn--block" bindtap="handleSubmit" loading="{{submitting}}" disabled="{{submitting}}">{{globalCopy.submitButton}}</button>
  </view>
</view>
